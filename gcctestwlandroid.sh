#!/bin/bash

# Compiler and output paths
GCC="/usr/bin/gcc"
OUTPUT="/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd/.tmp_wl_android.o"
SOURCE="/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd/wl_android.c"
DEP_FILE="/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd/.wl_android.o.d"

# Build the GCC command
CMD=(
    "$GCC"
    "-Wp,-MD,$DEP_FILE"
    "-nostdinc"
    "-isystem" "/usr/lib/gcc/aarch64-linux-gnu/11/include"
    "-I./arch/arm64/include"
    "-I./arch/arm64/include/generated"
    "-I./include"
    "-I./arch/arm64/include/uapi"
    "-I./arch/arm64/include/generated/uapi"
    "-I./include/uapi"
    "-I./include/generated/uapi"
    "-include" "./include/linux/kconfig.h"
    "-include" "./include/linux/compiler_types.h"
    "-D__KERNEL__"
    "-mlittle-endian"
    "-DKASAN_SHADOW_SCALE_SHIFT=3"
    "-Wall"
    "-Wundef"
    "-Wstrict-prototypes"
    "-Wno-trigraphs"
    "-fno-strict-aliasing"
    "-fno-common"
    "-fshort-wchar"
    "-Werror-implicit-function-declaration"
    "-Wno-format-security"
    "-Wno-array-compare"
    "-Wno-address"
    "-Wno-misleading-indentation"
    "-Wno-stringop-overread"
    "-Wno-array-parameter"
    "-Wno-enum-int-mismatch"
    "-std=gnu89"
    "-fno-PIE"
    "-mgeneral-regs-only"
    "-DCONFIG_AS_LSE=1"
    "-fno-asynchronous-unwind-tables"
    "-Wno-psabi"
    "-mabi=lp64"
    "-fno-delete-null-pointer-checks"
    "-Wno-frame-address"
    "-Wno-format-truncation"
    "-Wno-format-overflow"
    "-Wno-int-in-bool-context"
    "-Wno-address-of-packed-member"
    "-O2"
    "-fno-allow-store-data-races"
    "-Wframe-larger-than=2048"
    "-fstack-protector-strong"
    "-Wno-unused-but-set-variable"
    "-Wno-unused-const-variable"
    "-fno-omit-frame-pointer"
    "-fno-optimize-sibling-calls"
    "-fno-var-tracking-assignments"
    "-g"
    "-gdwarf-4"
    "-pg"
    "-Wdeclaration-after-statement"
    "-Wno-pointer-sign"
    "-Wno-stringop-truncation"
    "-Wno-zero-length-bounds"
    "-Wno-array-bounds"
    "-Wno-stringop-overflow"
    "-Wno-restrict"
    "-Wno-maybe-uninitialized"
    "-fno-strict-overflow"
    "-fno-merge-all-constants"
    "-fmerge-constants"
    "-fno-stack-check"
    "-fconserve-stack"
    "-Werror=implicit-int"
    "-Werror=strict-prototypes"
    "-Werror=date-time"
    "-Werror=incompatible-pointer-types"
    "-Werror=designated-init"
    "-fmacro-prefix-map=./="
    "-Wno-packed-not-aligned"
    "-Dlinux"
    "-DLINUX"
    "-DBCMDRIVER"
    "-DBCMDONGLEHOST"
    "-DBCMFILEIMAGE"
    "-DDHDTHREAD"
    "-DDHD_DEBUG"
    "-DSHOW_EVENTS"
    "-DGET_OTP_MAC_ENABLE"
    "-DWIFI_ACT_FRAME"
    "-DARP_OFFLOAD_SUPPORT"
    "-DSUPPORT_PM2_ONLY"
    "-DKEEP_ALIVE"
    "-DPKT_FILTER_SUPPORT"
    "-DDHDTCPACK_SUPPRESS"
    "-DDHD_DONOT_FORWARD_BCMEVENT_AS_NETWORK_PKT"
    "-DOEM_ANDROID"
    "-DMULTIPLE_SUPPLICANT"
    "-DTSQ_MULTIPLIER"
    "-DMFP"
    "-DDHD_8021X_DUMP"
    "-DPOWERUP_MAX_RETRY=0"
    "-DIFACE_HANG_FORCE_DEV_CLOSE"
    "-DWAIT_DEQUEUE"
    #"-DUSE_NEW_RSPEC_DEFS"
    "-DBCM_USE_PLATFORM_STRLCPY"
    "-DWL_EXT_IAPSTA"
    "-DWL_ESCAN"
    "-DCCODE_LIST"
    "-DSUSPEND_EVENT"
    "-DEAPOL_RESEND"
    "-DEAPOL_DYNAMATIC_RESEND"
    "-DWL_SCHED_SCAN"
    "-DENABLE_INSMOD_NO_FW_LOAD"
    "-DSOFTAP"
    "-DWL_WIRELESS_EXT"
    "-DUSE_IW"
    "-DWL_CFG80211"
    "-DWLP2P"
    "-DWL_CFG80211_STA_EVENT"
    "-DCUSTOM_PNO_EVENT_LOCK_xTIME=10"
    "-DWL_SUPPORT_AUTO_CHANNEL"
    "-DWL_SUPPORT_BACKPORTED_KPATCHES"
    "-DESCAN_RESULT_PATCH"
    "-DESCAN_BUF_OVERFLOW_MGMT"
    "-DVSDB"
    "-DWL_CFG80211_VSDB_PRIORITIZE_SCAN_REQUEST"
    "-DWLTDLS"
    "-DMIRACAST_AMPDU_SIZE=8"
    "-DWL_VIRTUAL_APSTA"
    "-DPNO_SUPPORT"
    "-DEXPLICIT_DISCIF_CLEANUP"
    "-DDHD_USE_SCAN_WAKELOCK"
    "-DSPECIFIC_MAC_GEN_SCHEME"
    "-DWL_IFACE_MGMT"
    "-DWLFBT"
    "-DWL_GCMP_SUPPORT"
    "-DWL_EXT_RECONNECT"
    "-DDHD_LOSSLESS_ROAMING"
    "-DGTK_OFFLOAD_SUPPORT"
    "-DRESTART_AP_WAR"
    "-DWL_CLIENT_SAE"
    "-DWL_OWE"
    "-DBCMSDIO"
    "-DMMC_SDIO_ABORT"
    "-DMMC_SW_RESET"
    "-DBCMLXSDMMC"
    "-DUSE_SDIOFIFO_IOVAR"
    "-DBDC"
    "-DDHD_USE_IDLECOUNT"
    "-DCUSTOM_SDIO_F2_BLKSIZE=256"
    "-DBCMSDIOH_TXGLOM"
    "-DBCMSDIOH_TXGLOM_EXT"
    "-DRXFRAME_THREAD"
    "-DDHDENABLE_TAILPAD"
    "-DSUPPORT_P2P_GO_PS"
    "-DBCMSDIO_RXLIM_POST"
    "-DBCMSDIO_TXSEQ_SYNC"
    "-DCONSOLE_DPC"
    "-DBCMSDIO_INTSTATUS_WAR"
    "-DOOB_INTR_ONLY"
    "-DCUSTOMER_OOB"
    "-DHW_OOB"
    "-DBUS_TYPE=\"\""
    "-DPROP_TXSTATUS"
    "-DPROPTX_MAXCOUNT"
    "-DPROP_TXSTATUS_VSDB"
    "-DBCMDMA64OSL"
    "-DANDROID_VERSION=12"
    "-DDHD_NOTIFY_MAC_CHANGED"
    "-DGSCAN_SUPPORT"
    "-DRTT_SUPPORT"
    "-DWL_SAR_TX_POWER"
    "-DCUSTOM_COUNTRY_CODE"
    "-DDHD_GET_VALID_CHANNELS"
    "-DDEBUGABILITY"
    "-DDBG_PKT_MON"
    "-DDHD_FW_COREDUMP"
    "-DAPF"
    "-DNDO_CONFIG_SUPPORT"
    "-DRSSI_MONITOR_SUPPORT"
    "-DDHD_WAKE_STATUS"
    "-DWL_LATENCY_MODE"
    "-DDHD_ARP_DUMP"
    "-DDHD_DHCP_DUMP"
    "-DDHD_ICMP_DUMP"
    "-DDHD_DNS_DUMP"
    "-DDHD_TRX_DUMP"
    "-DTPUT_MONITOR"
    "-DCHECK_DOWNLOAD_FW"
    "-DPKT_STATICS"
    "-DKSO_DEBUG"
    "-DDHD_TPUT_PATCH"
    "-DTCPACK_INFO_MAXNUM=10"
    "-DTCPDATA_INFO_MAXNUM=10"
    "-DDYNAMIC_MAX_HDR_READ"
    "-DUPDATE_MODULE_NAME"
    "-DGET_OTP_MODULE_NAME"
    "-DCOMPAT_OLD_MODULE"
    "-DBCMDHD_MODULAR"
    "-DCUSTOMER_HW"
    "-DDHD_OF_SUPPORT"
    "-DCUSTOMER_HW_ROCKCHIP"
    "-DBAND_AG"
    "-DSTATIC_WL_PRIV_STRUCT"
    "-DENHANCED_STATIC_BUF"
    "-DCONFIG_DHD_USE_STATIC_BUF"
    "-DDHD_USE_STATIC_MEMDUMP"
    "-DDHD_COMPILED=\"/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd\""
    "-I/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd/include/"
    "-I/gewu/home/geduer/gedulab/gdk8k/drivers/net/wireless/rockchip_wlan/rkwifi/bcmdhd/"
    "-DMODULE"
    "-DKBUILD_BASENAME=\"wl_android\""
    "-DKBUILD_MODNAME=\"bcmdhd\""
    "-c"
    "-o" "$OUTPUT"
    "$SOURCE"
)

# Execute the command
echo "Running compilation command..."
"${CMD[@]}"

# Check result
if [ $? -eq 0 ]; then
    echo "Compilation successful!"
else
    echo "Compilation failed!"
    exit 1
fi